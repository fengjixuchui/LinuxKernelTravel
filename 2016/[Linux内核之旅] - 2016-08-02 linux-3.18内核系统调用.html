<!DOCTYPE html>
<head>
	<meta http-equiv='Content-Type' content='text/html;charset=utf-8'>
	<meta name='viewport' content='width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no'>
	<title>
		linux-3.18内核系统调用
	</title>
	<script src='https://cdn.bootcss.com/jquery/1.10.2/jquery.min.js'>
	</script>
	<style>
		a {color: #607fa6;text-decoration:none;word-wrap:break-word;word-break:break-all;}.rich_media_title{padding-bottom:10px;margin-bottom:14px;border-bottom:1px solid #e7e7eb;font-weight:400;} .rich_media_meta_list{font-size:14px;margin-bottom: 22px;}
		.rich_media_meta{display:inline-block;vertical-align:middle;margin-right:8px;margin-bottom:10px;font-size:14px;}.rich_media_meta_text{color:#8c8c8c;color:rgba(0, 0, 0, 0.3)}.rich_media_meta_list
		em {font-style: normal;}@media screen and (max-width:768px){.rich_media{position:
		relative;padding: 20px 15px 15px;background-color: #fff;}}.rich_media_content{text-align:justify;} .rich_media_content * {max-width:100%!important;box-sizing: border-box!important;-webkit-box-sizing:
		border-box!important;word-wrap: break-word!important;}.rich_media_content
		blockquote {margin: 0;padding-left: 10px;border-left: 3px solid #dbdbdb;}.rich_media_content
		.list-paddingleft-2 {padding-left: 2.2em;}a.rich_media_meta_nickname{display: none;}@media screen and (min-width:1025px){.rich_media{position:relative;}a.rich_media_meta_nickname{display:inline-block!important;}span.rich_media_meta_nickname
		{display: inline-block!important;}.rich_media {width:677px;margin-left:auto;margin-right:auto;}}a.fwjm{font-size: 12px;color: #ececec;}.tenvideo_player {position: relative;width:
		100 %;height: 100 %;margin: auto;background: #000;}* {margin:0px;padding:0px;} body{line-height: 1.6;letter-spacing: .034em;}
		.dy_all {text-align: center;margin: 30px 0;} .dy_all a {display: inline-block;height:
		38px;line-height: 38px;padding: 0 18px;background-color: #009688;color:
		#fff;white-space: nowrap;font-size: 14px;border: none;border-radius: 2px;cursor:
		pointer;text-align: center;outline: 0;-webkit-appearance: none;transition:
		all .3s;-webkit-transition: all .3s;box-sizing: border-box;} img{max-width: 677px!important;}

		.crawler-info{padding: 8px 0;} .article-link>img{margin-left: 20px;width: 16px;}
		.comment-item::before,.comment-item::after{content:'';display:block;height:0;visibility:hidden;clear:both;*zoom:1;} .comment-item{margin-bottom:30px;}
		.avatar{width:12%; padding-right:10px;float:left;box-sizing:border-box;} .avatar img{width:100%;}
		.comment-body{float:left;width:88%;} .comment-body .comment-info{color:#b3b3b3;margin-bottom:4px;margin-top: -5px;} .comment-body .comment-info>span:last-child{float:right;} 
		.comment-author{border-left:4px solid green;padding-left:6px;margin:8px 0;}

		@media screen and (max-width: 420px) {.article-link>img {margin-left: 0px;}}
		@media screen and (min-width: 480px) {.avatar {width: 9%;}.comment-body {width: 91%;}}
	</style>
</head>
<body>
	<div id='js_article' class='rich_media'>
		<div class="crawler-info">
			<a href='https://www.52pojie.cn' class='fwjm' target='_blank'>
				提供的爬取软件来源于：52pojie.cn@夜泉 免费下载使用
			</a>
			<a href='https://mp.weixin.qq.com/s?__biz=MzI3NzA5MzUxNA==&amp;mid=2664602731&amp;idx=1&amp;sn=3c06b1bd050844d3ead4070fffd764b7&amp;chksm=f04db18ec73a389841fbe703b6c3276c17862edf581df1780ef90cf4304d7a79940d54357af0&amp;scene=27#wechat_redirect&cpage=65' target='_blank' class="article-link">
				<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAQCAMAAABA3o1rAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ1IDc5LjE2MzQ5OSwgMjAxOC8wOC8xMy0xNjo0MDoyMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk4QUEzQzVDNkNGQjExRTk5NzNBQ0VBMjgzMjY1NjkwIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk4QUEzQzVENkNGQjExRTk5NzNBQ0VBMjgzMjY1NjkwIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OThBQTNDNUE2Q0ZCMTFFOTk3M0FDRUEyODMyNjU2OTAiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OThBQTNDNUI2Q0ZCMTFFOTk3M0FDRUEyODMyNjU2OTAiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5TKSKsAAAAclBMVEUuLi77+/stLS1VVVXx8fFOTk7s7Ozt7e1qamp5eXlNTU2WlpZFRUU6Ojrq6urn5+d/f3/8/Pw9PT0/Pz+YmJg8PDyZmZlAQECfn5+QkJBBQUFra2vo6OhDQ0OSkpKenp5WVlY+Pj7r6+tpaWksLCz///9o6ILHAAAAJnRSTlP/////////////////////////////////////////////////AKd6gbwAAACNSURBVHjajJHpEoIwDISDVMotcnuCmLz/K9KCdlqO6v7p7Mw3yW4KxG85fnUkIVfZ5J0SsCtqcgRw0HzjQYY2AAOIdRuaK4ReAPJ5nmglL5qICahpU60C0uXguQ9TgIwGJoDnT9z/ABmxt60ot0N2CsDLfb9mvBxs9ql+n5o9bEDBgbif7/1F4g80CjAAqrVAnnsm5f8AAAAASUVORK5CYII=" />
			</a>
		</div>
		<div id="img-content">

                
                <h2 class="rich_media_title" id="activity-name">linux-3.18内核系统调用</h2>
                <div id="meta_content" class="rich_media_meta_list">
                                                            <span id="copyright_logo" class="rich_media_meta rich_media_meta_text meta_tag_text">原创：</span>
                                                                                        <span class="rich_media_meta rich_media_meta_text">
                                                        田野
                                                    </span>
                                                                
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt"><a href="javascript:void(0);">Linux内核之旅</a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">Linux内核之旅</strong>
                              <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">LinuxKernelTravel</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">Linux内核之旅</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>


                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2016-08-02</em>





                </div>

                
                
                                
                
                
                
                                                
                                <div class="rich_media_thumb_wrp" id="media">
                    
                                        
                                    </div>
                                                
                                
                
                <div class="rich_media_content " id="js_content">
                    

                    

                    
                    
                    <h1 style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(2, 30, 170); font-size: 16px;"><strong>1.系统调用基本概念</strong></span></h1><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">系统调用是指就是函数调用，只是调用的函数是系统函数，处于内核态而已。用户在调用系统调用时会向内核传递一个<strong>系统调用号</strong>，然后<strong>系统调用处理程序</strong>通过此号从<strong>系统调用表</strong>中找到相应的内核函数执行（也就是系统调用服务例程），</span></p><h1 style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(2, 30, 170); font-size: 16px;"><strong><br  /></strong></span></h1><h1 style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(2, 30, 170); font-size: 16px;"><strong>2.系统调用信息定义初始化</strong></span></h1><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">在arch/x86/kernel/syscall_64.c文件中定义并初始化了sys_call_table</span></p><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><img data-s="300,640" data-type="png" src="data:image/PNG;base64,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 " src="SeWfibBcBT0F67W6nbNu1NBXyuLrFV4PgIfKE62fRtJRp75vEf7pI6J4y1ddMbCa3mEo5FwbibFP4kzaN1koJEibQ"  data-ratio="0.5582255083179297" data-w="541"  /><br  /></span></p><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">sys_call_table的初始化使用了GCC的扩展语法， [0 ... __NR_syscall_max] = &amp;sys_ni_syscall将数组内容全部初始化为<br  />未实现（服务例程没有实际内容，下边介绍）；然后包含syscalls_64.h的内容逐项初始化，这个文件预先不存在，是在内核编译期间生成的（请看2.2）。</span></p><h2 style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(2, 30, 170); font-size: 16px;"><strong><br  /></strong></span></h2><h2 style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(2, 30, 170); font-size: 16px;"><strong>2.1 sys_ni_syscall</strong></span></h2><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">并不是所有的服务例程都有实际内容，sys_ni_syscall服务例程除了返回-ENOSYS外不做任何其他工作，在kernel/sys_ni.c文件中定义。</span></p><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><img data-s="300,640" data-type="png" src="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAATUAAABQAgMAAAAFPwrKAAAADFBMVEX///+ToaFISEweNHu8oOpLAAACA0lEQVRYw+2YwYrbMBCGJ+MchDCoh/Yucgo++QEWkkfYQx9o8CnkKYRPQk+hkgfYVzHkanBH8tpNu5vQetVll+iHJKNM+Jh/xoZxALLeW6vnz3Ua3IRZvZ6WhPw2nZT/My8u4grsiCtBXcEB8Qvnk4cbQoZ/GcMC9v8ZJ6k6WqAKj1ihkaYKOHV6goFzbWscQEuWKdbaihyaiNvtlO/5Jy9wWlOzAe6daYQQmogL9XXdncoxxzVvNfeOc+EkRMSVZV2XxSvVodlixFGjwWpyI84HnIQNmEBlHJKgLbNtxBX1FZzQOOEMChm7GHC+Cy3dhKFGHGhBiIDiNm42S9Es0FRdzAkmjLjgcja7fsa9vFCkdXJztFXbuiO6ingUqlen87nnS4wE8hSs5Q5InoFjq64yjtY8LT/44QfcltZTxE7C+bItv8K/vckkzWEf58QluvA912ch61PpMS1un3FLtXo74vOYvS/cY1pcVtZHkeM90YwL4nJIPUdaj8ujpjQ4MAcUIBbT+m5XDA8P/fkJ4Nt3TYcDb3aC9LRV/6MUeF+XpYLOQ1jsGAe80clFsPDMMQRcydRgNuJ40YSFbpkDFzho3oy7rE43YbIIS2cx+B2oYhhO5w7CdWeIH1kkuYWjuKrEuH1aXNa76WtaXKL/Lu4Sl3g3/thm7wqX+CbLysr6TT8BAL6bSCb0ATwAAAAASUVORK5CYII= " src="SeWfibBcBT0F67W6nbNu1NBXyuLrFV4Pgf8Dg8VeDY2WVxvK6RTxt85rfia7j2I7nfmicpMicaqycDFRA9PcNvLAew"  data-ratio="0.2588996763754045" data-w="309"  /><br  /></p><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">sys_ni_syscall的确是最简单的系统调用服务例程，表面上看，它可能并没有什么用处，但是，它在sys_call_table中占据了很多位置。多数位置上的sys_ni_syscal都代表了那些已经被内核中淘汰或者没有实际用处的系统调用。<br  />如果一个系统调用被淘汰，它所对应的服务例程就要被指定为sys_ni_syscall。我们并不能将它们的位置分配给其他的系统调用，因为一些老的代码可能还会使用到它们。否则，如果某个用户应用试图调用这些已经被淘汰的系统调用，所得到的结果，比如打开了一个文件，就会与预期完全不同，这将令人感到非常奇怪。其实，sys_ni_syscall中的"ni"即表示"not implemented（没有实现）"。</span></p><h2 style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><br  /></h2><h2 style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(2, 30, 170); font-size: 16px;"><strong>2.2 系统调用号</strong></span></h2><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">在linux-3.18.24/arch/x86/syscalls/目录中存放有系统调用号相关的文件，unistd_64.h、syscalls_64.h等文件都是在内核编译时根据syscalls目录中的脚本和系统调用号定义文件syscall_64.tbl生成的。</span></p><h3 style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(2, 30, 170); font-size: 16px;"><strong><br  /></strong></span></h3><h3 style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(2, 30, 170); font-size: 16px;"><strong>2.2.1 syscall_64.tbl</strong></span></h3><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">系统调用号定义在syscall_64.tbl(32位的为syscall_32.tbl)文件中。<br  />64-bit system call numbers and entry vectors<br  />The format is:<br  /><br  />The abi is "common", "64" or "x32" for this file.<br  />abi就是应用程序二进制接口<br  />A、应用程序 &lt;－&gt; 操作系统；<br  />B、应用程序 &lt;－&gt; （应用程序所用到的）库<br  />C 、应用程序各个组件之间<br  />类似于API的作用是使得程序的代码间的兼容，ABI目的是使得程序的二进制（级别）的兼容。<br  />common：64 bit mode和32 bit mode程序都能兼容的<br  />64: 64 bit mode的程序<br  />x32：运行在64 bit mode 下的32 bit的程序（x32 abi系统调用号从512开始）</span></p><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">syscall_64.tbl内容如下：</span></p><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><img data-s="300,640" data-type="png" src="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAAaUAAABoAgMAAAAsvQfjAAAACVBMVEX///8ZX5FISEzcdDAbAAAClElEQVRo3u2awY7aMBCGzahIkU9dqb1bnCI/BX2H7vuMcoryFBYny09ZG9ywkybj8bLQLfV/QRZ88+Mh5GcSlGpqamr6v/Wt+ApXW3IL+FEkTa3VBrBTx79kZdFbF9DqPi7ghB6cdqXSiZumwReAhRUO0I0Hg8OQVj1A1xnJrhLXFYClFWQrOHcCgvIiq16NgAWgYKVAtitQY/qIeIAegXMDs5W4gWhSA3mAfq+s8v106q2eYjtSNyBoL7AKysSjoQK4RXjn+lfpaBXuvZ2mpn9FXwrPY23BbeBnCYVar02gtKu7WdEUHsOk0TpbLp9TmAeoFU3hEV1MsJgQRaucwjywsCLROEYmkqFslVOYBwRWZaffKcwDGw08Wx0USht4SWEeeD2+XZEUVgftY6RKDotLClcAt6i8849SS+Gmpjf6/jir4/EZrZhZWFkdR9sTCopcUrgA7MiKpvA5W3sjsMopzANcNMYHXTUL88BX3qpTNbMwD9DDgqbwuR81szAPcClsIX7KXj4LVwArfRELa4GFNNa8MqawHGhqemaxKQyushoL8NFoat85BzzQak9WixRGky4wi2fhEkB2tUjhFA3GyGfhAkCtaDSqSOqKWZgHFtH4p5VkPp1TmAXYFJY3MKcwC9Dv1TKFAziL8llYDtyi8s4/Sm0Wbvr82t1e4hNa7dlnzbt+hsez4drZ4+VxVvRe4yKFh3T2dILi+Yr0lM7WOhbwa3cBN25rXlNYtKucwi7hxnSwdv12txi7STT2sYFeZDXPwqEbdWygXWsgnRqpFSgDsl3Ns7DqRoWdGtasNi4mXFNY1sB5Fgaz1UC1J7uiKRyUhiD6v0W+L3xyHoxFwIC95B2+T3hzBalaCjc1PbV+AfSmHsfUujaVAAAAAElFTkSuQmCC " src="SeWfibBcBT0F67W6nbNu1NBXyuLrFV4PgVoBQJPemFLtBKsgtHUmb72QMt73ErbFrHSmiaT9VvtWkvWOTHauyxsA"  data-ratio="0.24703087885985747" data-w="421"  /><br  /></p><h3 style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><br  /></h3><h3 style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(2, 30, 170); font-size: 16px;"><strong>2.2.2 如何生成syscalls_64.h、unistd_64.h等文件</strong></span></h3><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><img data-s="300,640" data-type="png" src="data:image/PNG;base64,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 " src="SeWfibBcBT0F67W6nbNu1NBXyuLrFV4PgyzyKYVpE85Zic6XATLAMWrYvrQdSmnKdk44rarmD8rlAafGcuk5oibVg"  data-ratio="0.7877697841726619" data-w=""  /><br  /></p><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">syscalls_64.h中一连串的宏其实完成的就是用文件syscall_64.tbl中声明的系统调用来初始化表sys_call_table中的每一项</span></p><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">syscallhdr.sh脚本用于生成unistd_64.h等文件</span></p><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><img data-s="300,640" data-type="png" src="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAAQkAAACfAgMAAACXTsQdAAAADFBMVEX///9ISEyToaEZX5Fuq7MaAAADdUlEQVRo3u2YwWrjMBCGR44EIQQqg30PPS0+7QMsrAzJ3QHrfUyOfQrTk8lT9AH2YfoAhe6M7CYbR7Kn3ZxS/YfKaujHzMT++8sAUVFRUfMSgd8vmyUUuLbgFpBg8xzEfl+LGhe729Vqb20FoCpk4Gc+BsAB102/gBRCZQBmK6TEpSzB6FSmeK21wo+lh3HEApqeQQukAoiRSqHhg0FgvIY0wFg23ar70a7aYtU5BhjHEDKtiIF72TN2pgwwNjiPZrXcbJqmrwMyuaWW6kwODGEco9LIULWH8QjIWCLj2DNwnsSgXj4YoPtesM3QPAZG08/DmEuGOjO0NX7GqY6hF1M6Bn4vJ4ZGBl3rUB2PcDx0BQ60SGimdGNkO7conGmuSlXnJnfXRhn//XF72dqzOOUWfyicSNRdKuxjSQPQJR97ho+trxn4rCXL057hY29jBvoYMs57ho956iiarmiL5Am4PnbFwGf+kCRYSXtIesasj10xHqE5HImBC+0ZPnbFOLbNAXqG2zN8zFtH0jNcLwwf8zCKtsP/DM/PLdfH3l9ufveOFX0sKioqKuq+NM5joHYUvnrhxSuLcZnHQJTnM4qGxZrBGOexEWO9YNVxmcdApBgUxN7UosILFmOcx5AhDUAmMFtqZh3jPEYMjV0ICzWXMc5jIFTPwGz3mTr+zWPEoFA89ML6XkZ5DO+PMldAnQhLYfSVwbi9rDshXASxqG+tCR8z/fLCYIR9zJ1nH+YZUz4m2HV4fWxrd8rkVc5iBHxsayo8UOLpjsMI+NgW/xoZlsUI+NjAMKxeAj5Gx9pP9OLzMUhVjS5GM314m2XcXtHHoi41mcfA8yLLy5jIYwALXv6YyGNMht/HIFeYx/YGIQxGwMfo1ZLMtOcFkkcBH0OGojwGP1nz8PoY1QHEeGHW4fEx1wvlMV6m8/pYLnCmdQ2LdwYjJPHlvzz7mDL/UUDU3SjkY6Ia9otXBiPgY3rYr+ef/qCPfYIR8jGj6VxJeWy+l5CPGU3PPmWY+TpCPgbIUC6Pcebh9zFiuCjFmEfIx069sBgBH7Oiyk3Ouj9ur5jHvpM42WEuj/EYYR+j/7m/GIwpHyPGH1Ydfh8r6ZmreO+DpnwM62C+U/L6WIa91ILlQEEfE6CFq4OTg6Z8jGb69fdjYEEJS+9PfzMYt1f0sXvRXycROEmjj3rmAAAAAElFTkSuQmCC " src="SeWfibBcBT0F67W6nbNu1NBXyuLrFV4Pg9NMwQBr6F5JNEmkLXx5SDlOnxQykSQSvNjPRresIZhRPOI42AyicEXA"  data-ratio="0.6" data-w="265"  /><br  /><span style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; font-size: 16px; background-color: rgb(255, 255, 255);">Makefile中指定输出到哪个目录</span></p><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; font-size: 16px; background-color: rgb(255, 255, 255);"><img data-s="300,640" data-type="png" src="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAAWQAAAA5AgMAAAB8ErkuAAAADFBMVEX///+ToaFISEweNHu8oOpLAAACtElEQVRYw+2XzWrjMBDHx2MXhChEh+5d7MnoFOg1ELNPkMPu+8z6VPoUoiehpzDkAfoqhb0GsiNLcu181OlhD7vrP1ixZc0vkxlphgAsWnSzmjz2N2ryTp0uLm7GYl6r0k1z4VtHqm4mS2JgDUADWYfRQT97SpY3kLv0+VXzWtE7M/ZZpGtExv66ifxw92NCrkZxTORxVCNZfUjdrlarA5Pz73PSSspktLWVVkiJLkTKo30hI5/RGmvAg1p129fDVX/35RANpApRCGCyihnSUmgtwqTWFY+i1kRWCARqEZr1uts/zpFDNFCfkRkJPdlYJkuntScCh+ADuXzblLPklMFM7rOlRmTNT1aA1gSEwWfEAu7X5Sz5IZKLSFbQ3PFUJOdoKITwQUQpGgV8GI0tHLtNziBniTP4TkZvjCRPvvWSFDq0zhnp0EPI4E9YHY6rxw7mhWnPUnPxCCJOl99+BLPMtRfu06hF/5KKPH6u9qs5rshrm0kdnXzrWAOwuQIcjoAJQMvPA5nCawth9oxcJzJeJw964oMNundm7LOO15gc28Gsz0G7L98nZDWKYyJXZ+QMvNDFsSUXGgST0+/jhkFmIEviLkK6riUvqri1tM/gTB3KlEMH35J5AYfycOwmaK6GoSgmSVChUoYW18QMUegiOpZPxaO2LSKl0lpk86os7+8f11MymUQO0RB0Rg61vif7QDaWWo+cU4G+J0fzCrZld0ZuRz4/DeS8nd/JxHWUNHvJe0Gwz9wHqmyuYA/rU3KOxi6Sq0jmCv3AU5Gco9H03YqjASkaVTZXF6JhrH/mJp/IIUucwXeydNxF0KOXzvCTle2L5ZxxX+EM+iqbKzi+vv3anO4PMb7to8At7uIRFGJqqbL5le183kOuNY/+MM6bL1q0aNH/o13Bfxz+MvKiP6/f5Q+2Fn7A27wAAAAASUVORK5CYII= " src="SeWfibBcBT0F67W6nbNu1NBXyuLrFV4PgbMG0wPYhSBNvDON282IZp4diaZH1aGbicvFbKjvEoiceE0zcEeKmRo9Jw"  data-ratio="0.1601123595505618" data-w="356"  /><br  /></span></p><h1 style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(2, 30, 170); font-size: 16px;"><strong><br  /></strong></span></h1><h1 style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(2, 30, 170); font-size: 16px;"><strong>3. 系统服务例程</strong></span></h1><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">linux-3.18/kernel/sys.c中添加函数定义，即就是自己系统调用的服务例程，可以添加进sys.c文件中，也可以单独在kernel目录下创建一个服务例程文件（必须将此.c文件添加进该目录下的Makefile文件中，即就是以模块形式编译进内核），下边是直接添加进sys.c文件中：</span></p><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; font-size: 16px; background-color: rgb(255, 255, 255);"></span><img data-s="300,640" data-type="png" src="data:image/PNG;base64,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 " src="SeWfibBcBT0F67W6nbNu1NBXyuLrFV4Pgs7vobFGicEgF4WBdZpvibq9R4S6uSMZib2WogckxVTehRfKWDPO7YunAg"  data-ratio="0.580952380952381" data-w="420"  /><br  /><span style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; font-size: 16px; background-color: rgb(255, 255, 255);">asmlinkage修饰符是GCC中一个比较特殊的标志，因为GCC常用的一种编译方法是使用寄存器传递函数的参数，而加了asmlinkage修饰符的函数必须从堆栈中而不是寄存器中获取参数。内核中所有系统调用的实现都是用了这个修饰符。内核在sys.c文件中定义了SYSCALL_DEFINE0~SYSCALL_DEFINE6等七个提供便利的宏,如下所示：</span></p><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; font-size: 16px; background-color: rgb(255, 255, 255);"><img data-s="300,640" data-type="png" src="data:image/PNG;base64,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 " src="SeWfibBcBT0F67W6nbNu1NBXyuLrFV4PgwjwrZW03ymcggOQuib3WibpOICRf7y3kicEtGkXJ78c3O1dzTbs3gN6aA"  data-ratio="0.19784172661870503" data-w=""  /><br  /><span style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);">SYSCALL_DEFINE宏后边的数字说明了系统调用name的输入参数个数，这些宏都已一个基础宏SYSCALL_DEFINEx实现：</span></span></p><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; font-size: 16px; background-color: rgb(255, 255, 255);"><img data-s="300,640" data-type="png" src="data:image/PNG;base64,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 " src="SeWfibBcBT0F67W6nbNu1NBXyuLrFV4PgRtRpicMoVzMS9IOdWD7NGdXbNnHlibThJ2aAcJ4m5PQ0ynEZrYFjaDJw"  data-ratio="0.21402877697841727" data-w=""  /><br  /><span style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);">宏定义中可以用</span><strong style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);">##</strong><span style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);">运算符把运算符前后两个预处理符号连接成一个预处理符号；</span><br style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"  /><span style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);">GCC用一个名为</span><strong style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><strong>VA_ARGS</strong></strong><span style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);">保留关键字实现了宏定义实现可变数目参数的目的；</span><br style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"  /><strong style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);">SC_DECL和</strong><span style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);">MAP也都是一个宏定义,主要用于系统调用的参数问题：</span></span></p><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; font-size: 16px; background-color: rgb(255, 255, 255);"><img data-s="300,640" data-type="png" src="data:image/PNG;base64,iVBORw0KGgoAAAANSUhEUgAAAaMAAADGAgMAAAACtQc6AAAACVBMVEX///+ToaFISExkcBE4AAAFRUlEQVR42u2bQY6jOBSGny0iWaxcUthbWUWcwmn17CkJ7uNCainKKZhaIU45D5sEB0wVYMj0TPtfhJST+JON4atnJQAhISEhIf/vkMczvjMpcjzz61ASCZD3I4hvSjXqvAcJJBCrM3oDJURpzRlZ3qsrRdaSrAZ6o0KcQG1OimQi8yRLyF+QP5PSalsSl/JCCPaWXUyP9ERFWiKJXbclvYG8FC0JD3dSJegOpCKTFzAk6EiM7UJqx0QM6T57SIISInY9QkbkYatV/gZJlh+y5P09MysiPjVpDXg9nW/bkiZDHpcs36P7pmmq/q9s58GEhDgzdG5kPW6boQn5gL+8Q0mkw7lsD5LTubXpmfW9S2oOq0lu5wq2Pcnt3JbUOrdRQCskxTXI9u/ag+R2Lp4n7SccE2OkbdRjotSD5HYu9CSoexKkXufJ5VyLRK0xoSD9xuRwLjPOZUQyFmkSp5BR6rHKJ5zbKO1c+iFpE7WN+P9flUHzsZ40mc650rob8Q3vRiPnHmy23GFAISGjjK5Rrh8n1MtnduJK5G7g7h7kRC9W+4Rz05mkumZoFHXvkX7i3Rlv+Q00tB6RnM5Vpvpko5kYCPFcMUpj9SAr1ZJAlZSxwaxOOHc+6YTSskmtAfCRMhiQJpzb1bnauT1prN47CedL5wSa1DCgQ9KEc6nl3J40Vu9JnPCE4JiuyiZd8UPVgDTDuSOSpd6TSLHBJuHbY1WyWI3Pk9O5wnLumFRaJFU+kXC8IETJKDDHmBzOVap3bl+EWuo9PpFAXj80nBnSY+1Jm/Stc3uSpd6O9Jl+NgoXyo/r34aElyPUTVXVcTUgTaZ37lO5e1fv4MLm7k6n70ZO52aDT8vutRjf3TcfIG2advWkjbOzkJC5+cOdi2LpetzbubqYM9nZuU+kpc6NYYlzmYdzu33Ymc4VHs7tSXs7V6kFzqXwKufiBK93bgrBucG5IdvlVc6lL3PuXJK/c2Nrx/dpJjZ37mk2yde55SLnVh7OLRfVuWy9cyldVOcyD+c2S5zLmIdzKbzKufGSOhcXTXBuSMhX+T3rXOHh3EYt2VsWHs5VS5wLlU+du8S5VHg4t1niXCY8nKuW1LnsZXWuEK+qc+P6ZXvL4lV1LoQ6NyTk6/yezvXaW17i3Lj2ce6ivWVY79wTLKpzYb1zT+kS58YedW65zLk+de6yvWWPOtci7VznIulVdW6zxLmhzg0J+Try/iT64rVv2maFOJ5Nt8CcHwtMOHdEStPWpD8J71ryXF/XBUqnmEtyOtdqMPMSn/FeqDRJv8a5JnHe3S+//wLmRJ3rIKFJfxVJ/iC94ejaR+OA70kTdW4Unx2kdkzvMjKf06Tk0r3he9JEnRvR8pnEruhsEkX8yG3SG37oOI80UedGlA5JsVKER5LfSQmSMn4h2ezz5KxzHST02wHP04MkJeAQLyBnkibqXELpAbQCu9WiSWZMugU/oEn3tcdnkJzOJfHt1xPpfEOTtqTcXHuEvGeQJPkxIfk80lQeS3+nu5GtyeOjlWKzst51KIpCH7ruk6LIVw8pJCQkJCQkJCTk34w0h41+xv9FHgTp39eoztW7wrSO8VBvTBrWuXpnrmwPWNyAMK0cgK7p3sq4zgWBJFXiYVvSqM6FdscbSfonL5HZM05bktlUXp9RnQtnQ6o1yYxJ79ObTeX1GdW5QO0xGVLckXBw6zOqc+8ksEjiTirXQR5jeq5zrbUnCIiDnj25xewN6lzafsVQX08VFrYQt6S0QlK7qf9UGm6b7grY/m7U1bmNtZqPa/sKCQn5j+cfzBTYOo9wA5oAAAAASUVORK5CYII= " src="SeWfibBcBT0F67W6nbNu1NBXyuLrFV4Pgv5hMAoCoTJxpKUqTJEXDH4MHeuZbEy522ELoVtckHzWlYrF7g7md2w"  data-ratio="0.47255369928400953" data-w="419"  /><br  /></span></p><h3 style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">对于系统调用open定义fs/open.c</span></h3><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">SYSCALL_DEFINE3(open, const char __user *, filename, int, flags, umode_t, mode)<br  />结合上边宏的分析展开过程如下：</span></p><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><img data-s="300,640" data-type="png" src="data:image/PNG;base64,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 " src="SeWfibBcBT0F67W6nbNu1NBXyuLrFV4PgA8bYqC24vicyvDj3IeFeic5hF6T5HWWcpd3Eicq196DictkZSDLbe5Hmxw"  data-ratio="0.22302158273381295" data-w=""  /><br  /></p><h1 style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(2, 30, 170); font-size: 16px;"><strong><br  /></strong></span></h1><h1 style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(2, 30, 170); font-size: 16px;"><strong>4.添加系统调用号</strong></span></h1><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">linux-3.18/arch/x86/syscalls/syscall_64.tbl</span></p><pre class="prettyprint linenums language-undefined prettyprinted" name="code" style=" white-space: pre-wrap; word-wrap: break-word;  overflow-y: hidden; overflow-x: auto; color: rgb(54, 46, 43); font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255); "><p><code><span style="font-size: 16px;"><span class="lit" style="font-size: 16px; color: rgb(25, 95, 145);">322</span><span class="pln" style="font-size: 16px; color: rgb(72, 72, 76);"> common tycall sys_tycall</span></span></code></p></pre><h1 style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(2, 30, 170); font-size: 16px;"><strong><br  /></strong></span></h1><h1 style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(2, 30, 170); font-size: 16px;"><strong>5. 在内核头文件中，添加服务例程的声明</strong></span></h1><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">在include/linux/syscalls.h文件的最后，#endif之前加入系统调用服务例程sys_tycall()的声明：</span></p><pre class="prettyprint linenums language-undefined prettyprinted" name="code" style=" white-space: pre-wrap; word-wrap: break-word;  overflow-y: hidden; overflow-x: auto; color: rgb(54, 46, 43); font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255); "><p><code><span style="font-size: 16px;"><span class="pln" style="font-size: 16px; color: rgb(72, 72, 76);">asmlinkage </span><span class="kwd" style="font-size: 16px; color: rgb(30, 52, 123);">long</span><span class="pln" style="font-size: 16px; color: rgb(72, 72, 76);"> sys_tycall</span><span class="pun" style="font-size: 16px; color: rgb(147, 161, 161);">();</span></span></code></p></pre><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">注意： 本操作并非必须，通常将体系结构无关的系统调用的声明放置于此。此文件中的声明并不是给用户程序用的</span></p><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">添加完成，后编译内核，即可测试是否添加成功。</span></p><h1 style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><br  /></h1><h1 style="color: rgb(54, 46, 43); font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(2, 30, 170); font-size: 16px;"><strong>6. 用户态测试系统调用</strong></span></h1><pre class="prettyprint linenums language-undefined prettyprinted" name="code" style=" white-space: pre-wrap; word-wrap: break-word;  overflow-y: hidden; overflow-x: auto; color: rgb(54, 46, 43); font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255); "><p><code><span style="font-size: 16px;"><span class="com" style="font-size: 16px; color: rgb(147, 161, 161);">#include</span><span class="pln" style="font-size: 16px; color: rgb(72, 72, 76);"> </span><span class="str" style="font-size: 16px; color: rgb(221, 17, 68);">&lt;stdio.h&gt;</span></span></code></p><p><code><span style="font-size: 16px;"><span class="com" style="font-size: 16px; color: rgb(147, 161, 161);">#include</span><span class="pln" style="font-size: 16px; color: rgb(72, 72, 76);"> </span><span class="str" style="font-size: 16px; color: rgb(221, 17, 68);">&lt;sys/syscall.h&gt;</span></span></code></p><p><code><span style="font-size: 16px;">&nbsp;</span></code></p><p><code><span style="font-size: 16px;"><span class="com" style="font-size: 16px; color: rgb(147, 161, 161);">#define</span><span class="pln" style="font-size: 16px; color: rgb(72, 72, 76);"> SYS_tycall </span><span class="lit" style="font-size: 16px; color: rgb(25, 95, 145);">322</span></span></code></p><p><code><span style="font-size: 16px;"><span class="pln" style="font-size: 16px; color: rgb(72, 72, 76);">main</span><span class="pun" style="font-size: 16px; color: rgb(147, 161, 161);">(){</span></span></code></p><p><code><span style="font-size: 16px;"><span class="pln" style="font-size: 16px; color: rgb(72, 72, 76);"> &nbsp; &nbsp;</span><span class="typ" style="font-size: 16px; color: teal;">pid_t</span><span class="pln" style="font-size: 16px; color: rgb(72, 72, 76);"> pid</span><span class="pun" style="font-size: 16px; color: rgb(147, 161, 161);">;</span></span></code></p><p><code><span style="font-size: 16px;"><span class="pln" style="font-size: 16px; color: rgb(72, 72, 76);"> &nbsp; &nbsp;pid </span><span class="pun" style="font-size: 16px; color: rgb(147, 161, 161);">=</span><span class="pln" style="font-size: 16px; color: rgb(72, 72, 76);"> syscall</span><span class="pun" style="font-size: 16px; color: rgb(147, 161, 161);">(</span><span class="pln" style="font-size: 16px; color: rgb(72, 72, 76);">SYS_tycall</span><span class="pun" style="font-size: 16px; color: rgb(147, 161, 161);">);</span></span></code></p><p><code><span style="font-size: 16px;"><span class="pln" style="font-size: 16px; color: rgb(72, 72, 76);"> &nbsp; &nbsp;printf</span><span class="pun" style="font-size: 16px; color: rgb(147, 161, 161);">(</span><span class="str" style="font-size: 16px; color: rgb(221, 17, 68);">"SYS_tycall = %d\n"</span><span class="pun" style="font-size: 16px; color: rgb(147, 161, 161);">,</span><span class="pln" style="font-size: 16px; color: rgb(72, 72, 76);">pid</span><span class="pun" style="font-size: 16px; color: rgb(147, 161, 161);">);</span></span></code></p><p><code><span style="color: rgb(147, 161, 161); font-size: 16px;">}</span></code></p></pre><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">编译执行，正确输出进程pid即可。<br  />以上就是新版内核系统调用的过程，添加自己的系统调用总共就三部：<br  />a. 定义系统调用服务例程<br  />b. 添加系统调用号<br  />c. 添加系统调用声明<br  />d. 测试</span></p><p style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(54, 46, 43); font-family: Arial; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);"><br  /></span></p><p><br  /></p>
                </div>
                

                
  <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display: none;"></div>


                
                <div class="read-more__area" id="js_more_read_area" style="display:none;">
                    
                </div>

                
                                <div class="reward_area tc reward_area_primary" id="js_reward_area" style="display:none;">
                    <div class="reward-avatar" style="display: none;" id="js_reward_avatar">
                        <img src="" alt="" id="js_reward_author_head">
                    </div>
                    
                                        <div class="reward-author" style="display: none;" id="js_reward_author">田野</div>
                                                            <p class="reward_button_wrp">
                      <span id="js_author_reward_qrcode" class="reward_pop_panel">
                        <img id="js_author_reward_qrcode_img" src="" alt="赞赏二维码">
                        <strong>微信扫一扫赞赏作者</strong>
                      </span>
                        <a class="reward_button" id='js_reward_link' href="##"><span id="js_reward_link_text">赞赏</span></a>
                    </p>
                    <div id="js_reward_inner" class="reward_area_inner" style="display:none;">
                        <p class="weui-loadmore weui-loadmore_line reward_user_tips" id="js_reward_total_parent">
                          <span class="weui-loadmore__tips">
                            <a href="javascript:;" id="js_reward_total"></a>&nbsp;<span id="js_reward_total_text">人赞赏</span>
                        </span>
                        </p>
                        
                        <div id="js_reward_list" class="reward_user_list"></div>
                        <div id="js_reward_pagination" class="simple_pagination" style="display: none;">
                          <button disabled class="btn_sp_prev js_reward_pagination_prev">上一页</button>
                          <span class="sp_page_num_area">
                            <a class="sp_page_current js_reward_pagination_curpage" href="javascript:;">1</a>&#47;<span class="sp_page_num js_reward_pagination_totalpage">3</span>
                          </span>
                          <button class="btn_sp_next js_reward_pagination_next">下一页</button>
                        </div>
                    </div>
                </div>
                                            </div>
		<div class="comment">
			<h3 style="margin:26px 0;font-weight:100;padding-bottom:4px;border-bottom:1px solid #ccc;">精选留言</h3>
		    暂无...
		</div>
	</div>
	<div class='dy_all'>
		<a href='https://www.52pojie.cn/' target='_blank'>
			吾爱破解论坛
		</a>
	</div>
</body>