<!DOCTYPE html>
<head>
	<meta http-equiv='Content-Type' content='text/html;charset=utf-8'>
	<meta name='viewport' content='width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no'>
	<title>
		内核调试神器SystemTap — 更多功能与原理（三）
	</title>
	<script src='https://cdn.bootcss.com/jquery/1.10.2/jquery.min.js'>
	</script>
	<style>
		a {color: #607fa6;text-decoration:none;word-wrap:break-word;word-break:break-all;}.rich_media_title{padding-bottom:10px;margin-bottom:14px;border-bottom:1px solid #e7e7eb;font-weight:400;} .rich_media_meta_list{font-size:14px;margin-bottom: 22px;}
		.rich_media_meta{display:inline-block;vertical-align:middle;margin-right:8px;margin-bottom:10px;font-size:14px;}.rich_media_meta_text{color:#8c8c8c;color:rgba(0, 0, 0, 0.3)}.rich_media_meta_list
		em {font-style: normal;}@media screen and (max-width:768px){.rich_media{position:
		relative;padding: 20px 15px 15px;background-color: #fff;}}.rich_media_content{text-align:justify;} .rich_media_content * {max-width:100%!important;box-sizing: border-box!important;-webkit-box-sizing:
		border-box!important;word-wrap: break-word!important;}.rich_media_content
		blockquote {margin: 0;padding-left: 10px;border-left: 3px solid #dbdbdb;}.rich_media_content
		.list-paddingleft-2 {padding-left: 2.2em;}a.rich_media_meta_nickname{display: none;}@media screen and (min-width:1025px){.rich_media{position:relative;}a.rich_media_meta_nickname{display:inline-block!important;}span.rich_media_meta_nickname
		{display: inline-block!important;}.rich_media {width:677px;margin-left:auto;margin-right:auto;}}a.fwjm{font-size: 12px;color: #ececec;}.tenvideo_player {position: relative;width:
		100 %;height: 100 %;margin: auto;background: #000;}* {margin:0px;padding:0px;} body{line-height: 1.6;letter-spacing: .034em;}
		.dy_all {text-align: center;margin: 30px 0;} .dy_all a {display: inline-block;height:
		38px;line-height: 38px;padding: 0 18px;background-color: #009688;color:
		#fff;white-space: nowrap;font-size: 14px;border: none;border-radius: 2px;cursor:
		pointer;text-align: center;outline: 0;-webkit-appearance: none;transition:
		all .3s;-webkit-transition: all .3s;box-sizing: border-box;} img{max-width: 677px!important;}

		.crawler-info{padding: 8px 0;} .article-link>img{margin-left: 20px;width: 16px;}
		.comment-item::before,.comment-item::after{content:'';display:block;height:0;visibility:hidden;clear:both;*zoom:1;} .comment-item{margin-bottom:30px;}
		.avatar{width:12%; padding-right:10px;float:left;box-sizing:border-box;} .avatar img{width:100%;}
		.comment-body{float:left;width:88%;} .comment-body .comment-info{color:#b3b3b3;margin-bottom:4px;margin-top: -5px;} .comment-body .comment-info>span:last-child{float:right;} 
		.comment-author{border-left:4px solid green;padding-left:6px;margin:8px 0;}

		@media screen and (max-width: 420px) {.article-link>img {margin-left: 0px;}}
		@media screen and (min-width: 480px) {.avatar {width: 9%;}.comment-body {width: 91%;}}
	</style>
</head>
<body>
	<div id='js_article' class='rich_media'>
		<div class="crawler-info">
			<a href='https://www.52pojie.cn' class='fwjm' target='_blank'>
				提供的爬取软件来源于：52pojie.cn@夜泉 免费下载使用
			</a>
			<a href='https://mp.weixin.qq.com/s?__biz=MzI3NzA5MzUxNA==&amp;mid=414814418&amp;idx=1&amp;sn=5a0b269e14aa41cc3b1f2ed713e5de87&amp;chksm=7626bd374151342168d6fac053409fa1e657557b7b0124b7cd27bef207b2cc22ee01b69ec2f1&amp;scene=27#wechat_redirect&cpage=81' target='_blank' class="article-link">
				<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAQCAMAAABA3o1rAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ1IDc5LjE2MzQ5OSwgMjAxOC8wOC8xMy0xNjo0MDoyMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk4QUEzQzVDNkNGQjExRTk5NzNBQ0VBMjgzMjY1NjkwIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk4QUEzQzVENkNGQjExRTk5NzNBQ0VBMjgzMjY1NjkwIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OThBQTNDNUE2Q0ZCMTFFOTk3M0FDRUEyODMyNjU2OTAiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OThBQTNDNUI2Q0ZCMTFFOTk3M0FDRUEyODMyNjU2OTAiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5TKSKsAAAAclBMVEUuLi77+/stLS1VVVXx8fFOTk7s7Ozt7e1qamp5eXlNTU2WlpZFRUU6Ojrq6urn5+d/f3/8/Pw9PT0/Pz+YmJg8PDyZmZlAQECfn5+QkJBBQUFra2vo6OhDQ0OSkpKenp5WVlY+Pj7r6+tpaWksLCz///9o6ILHAAAAJnRSTlP/////////////////////////////////////////////////AKd6gbwAAACNSURBVHjajJHpEoIwDISDVMotcnuCmLz/K9KCdlqO6v7p7Mw3yW4KxG85fnUkIVfZ5J0SsCtqcgRw0HzjQYY2AAOIdRuaK4ReAPJ5nmglL5qICahpU60C0uXguQ9TgIwGJoDnT9z/ABmxt60ot0N2CsDLfb9mvBxs9ql+n5o9bEDBgbif7/1F4g80CjAAqrVAnnsm5f8AAAAASUVORK5CYII=" />
			</a>
		</div>
		<div id="img-content">

                
                <h2 class="rich_media_title" id="activity-name">内核调试神器SystemTap — 更多功能与原理（三）</h2>
                <div id="meta_content" class="rich_media_meta_list">
                                                                                                            <span class="rich_media_meta rich_media_meta_text">
                                                        zhangskd
                                                    </span>
                                                                
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt"><a href="javascript:void(0);">Linux内核之旅</a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">Linux内核之旅</strong>
                              <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">LinuxKernelTravel</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">Linux内核之旅</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>


                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2016-01-04</em>





                </div>

                
                
                                
                
                
                
                                                
                                                                
                                
                
                <div class="rich_media_content " id="js_content">
                    

                    

                    
                    
                    <h2 style="font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><strong>用户空间</strong></h2><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"> </p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">SystemTap探测用户空间程序需要utrace的支持，3.5以上的内核版本默认支持。</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">对于3.5以下的内核版本，需要自己打相关补丁。</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">更多信息：</span><span style="font-size: 16px;">http://sourceware.org/systemtap/wiki/utrace</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">需要：</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">debugging information for the named program</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">utrace support in the kernel</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><strong>(1) Begin/end</strong></span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">探测点：</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">进程/线程创建时</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">进程/线程结束时</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process.begin</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(&quot;PATH&quot;).begin</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(PID).begin</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process.thread.begin</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(&quot;PATH&quot;).thread.begin</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(PID).thread.begin</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process.end</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(&quot;PATH&quot;).end</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(PID).end</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process.thread.end</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(&quot;PATH&quot;).thread.end</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(PID).thread.end</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><strong>(2) Syscall</strong></span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">探测点：</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">系统调用开始</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">系统调用返回</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process.syscall</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(&quot;PATH&quot;).syscall</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(PID).syscall</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process.syscall.return</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(&quot;PATH&quot;).syscall.return</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(PID).syscall.return</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">可用的进程上下文变量：</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">$syscall // 系统调用号</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">$argN ($arg1~$arg6) // 系统调用参数</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">$return // 系统调用返回值</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><strong>(3) Function/statement</strong></span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">探测点：</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">函数入口处</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">函数返回处</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">文件中某行</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">函数中的某个标签</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(&quot;PATH&quot;).function(&quot;NAME&quot;)</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(&quot;PATH&quot;).statement(&quot;*@FILE.c:123&quot;)</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(&quot;PATH&quot;).function(&quot;*&quot;).return</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(&quot;PATH&quot;).function(&quot;myfunc&quot;).label(&quot;foo&quot;)</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><strong>(4) Absolute variant</strong></span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">探测点：</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">进程的虚拟地址</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(PID).statement(ADDRESS).absolute</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">A non-symbolic probe point uses raw, unverified virtual addresses and provide no $variables.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">The target PID parameter must identify a running process and ADDRESS must identify a valid instruction address.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">This is a guru mode probe.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><strong>(5) Target process</strong></span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">探测点：</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">动态链接库中的函数(比如glibc)</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Target process mode (invoked with stap -c CMD or -x PID) implicitly restricts all process.* probes to the given child</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">If PATH names a shared library, all processes map that shared library can be probed.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">If dwarf debugging information is installed, try using a command with this syntax:</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">probe process(&quot;/lib64/libc-2.8.so&quot;).function(&quot;...&quot;) { ... }</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><strong>(6) Instruction probes</strong></span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">探测点：</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">单条指令</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">指令块</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(&quot;PATH&quot;).insn</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(PID).insn</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(&quot;PATH&quot;).insn.block</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">process(PID).insn.block</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">The .insn probe is called for every single-stepped instruction of the process described by PID or PATH.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">The .insn.block probe is called for every block-stepped instruction of the process described by PID or PATH.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Using this feature will significantly slow process execution.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">统计一个进程执行了多少条指令：</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">stap -e &#39;global steps; probe process(&quot;/bin/ls&quot;).insn {steps++}; probe end {printf(&quot;Total instruction: %d\n&quot;, steps)}&#39; \</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">    -c /bin/ls</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><strong>(7) 使用</strong></span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">gcc -g3 -o test test.c</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">stap -L &#39;process(&quot;./test&quot;).function(&quot;*&quot;)&#39; // 显示程序中的函数和变量</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">调试等级：</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Request debugging information and also use level to specify how much information. The default level is 2.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Level 0 produces no debug information at all. Thus, -g0 negates -g.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Level 1 produces minimal information, enough for making backtraces in parts of the program that you don&#39;t</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">plan to debug. This includes descriptions of functions and external variables, but no information about local</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">variables and no line numbers.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Level 3: includes extra information, such as all the macro definitions present in the program.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><h2 style="font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">高级功能</span></h2><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><strong>(1) 自建脚本库</strong></span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">A tapset is just a script that designed for reuse by installation into a special directory.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Systemtap attempts to resolve references to global symbols (probes, functions, variables) that are not defined</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">within the script by a systematic search through the tapset library for scripts that define those symbols.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">A user may give additional directories with the -I DIR option.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">构建自己的库：</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">1. 创建库目录mylib，添加两个库文件</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">time-default.stp</span></p><ol start="1" class="dp-j list-paddingleft-2" style=""><li><p><span style="color: black; font-size: 16px; background-color: inherit;">function __time_value() {  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">    <span class="keyword" style="font-size: 16px; color: rgb(0, 102, 153); font-weight: bold; background-color: inherit;">return</span> gettimeofday_us()  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">}  </span></p></li></ol><p><span style="font-family: Arial; line-height: 26px; font-size: 16px; background-color: rgb(255, 255, 255);">time-common.stp</span></p><ol start="1" class="dp-j list-paddingleft-2" style=""><li><p><span style="color: black; font-size: 16px; background-color: inherit;">global __time_vars  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">function timer_begin(name) {  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">    __time_vars[name] = __time_value()  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">}  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">function timer_end(name) {  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">    <span class="keyword" style="font-size: 16px; color: rgb(0, 102, 153); font-weight: bold; background-color: inherit;">return</span> __time_value() - __time_vars[name]  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">}  </span></p></li></ol><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">2. 编写应用脚本</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">tapset-time-user.stp</span></p><ol start="1" class="dp-j list-paddingleft-2" style=""><li><p><span style="color: black; font-size: 16px; background-color: inherit;">probe begin {  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">    timer_begin(<span class="string" style="font-size: 16px; color: blue; background-color: inherit;">&quot;bench&quot;</span>)  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">    <span class="keyword" style="font-size: 16px; color: rgb(0, 102, 153); font-weight: bold; background-color: inherit;">for</span>(i=<span class="number" style="font-size: 16px; color: rgb(192, 0, 0); background-color: inherit;">0</span>; i&lt;<span class="number" style="font-size: 16px; color: rgb(192, 0, 0); background-color: inherit;">1000</span>; i++) ;  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">    printf(<span class="string" style="font-size: 16px; color: blue; background-color: inherit;">&quot;%d cycles\n&quot;</span>, timer_end(<span class="string" style="font-size: 16px; color: blue; background-color: inherit;">&quot;bench&quot;</span>))  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">    exit()  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">}  </span></p><p><span style="color: black; font-size: 16px; background-color: inherit;"></span></p></li></ol><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">3. 执行</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">stap -I mylib/ tapset-time-user.stp</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><strong>(2) 探测点重命名</strong></span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">主要用于在探测点之上提供一个抽象层。</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Probe point aliases allow creation of new probe points from existing ones.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">This is useful if the new probe points are named to provide a higher level of abstraction.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">格式：</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">probe new_name = existing_name1, existing_name2[, ..., existing_nameN]</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">{</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">    prepending behavior</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">}</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">实例：</span></p><ol start="1" class="dp-j list-paddingleft-2" style=""><li><p><span style="color: black; font-size: 16px; background-color: inherit;">probe syscallgroup.io = syscall.open, syscall.close,  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">             syscall.read, syscall.write  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">{  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">    groupname = <span class="string" style="font-size: 16px; color: blue; background-color: inherit;">&quot;io&quot;</span>  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">}  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">probe syscallgroup.process = syscall.fork, syscall.execve  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">{  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">    groupname = <span class="string" style="font-size: 16px; color: blue; background-color: inherit;">&quot;process&quot;</span>  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">}  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">probe syscallgroup.*  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">{  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">    groups[execname() . <span class="string" style="font-size: 16px; color: blue; background-color: inherit;">&quot;/&quot;</span> . groupname]++  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">}  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">global groups  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">probe end  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">{  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">    foreach (eg in groups+)  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">        printf(<span class="string" style="font-size: 16px; color: blue; background-color: inherit;">&quot;%s: %d\n&quot;</span>, eg, groups[eg])  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">}  </span></p></li></ol><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><strong>(3) 嵌入C代码</strong></span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">SystemTap provides an &quot;escape hatch&quot; to go beyond what the language can safely offer.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">嵌入的C代码段用%{和%}括起来，执行脚本时要加-g选项。</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">提供一个THIS宏，可以用于获取函数参数和保存函数返回值。</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">实例：</span></p><ol start="1" class="dp-j list-paddingleft-2" style=""><li><p><span style="color: black; font-size: 16px; background-color: inherit;">%{  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">#include &lt;linux/sched.h&gt;  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">#include &lt;linux/list.h&gt;  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">%}  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">function process_list()  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">%{  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">    struct task_struct *p;  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">    struct list_head *_p, *_n;  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">    printk(<span class="string" style="font-size: 16px; color: blue; background-color: inherit;">&quot;%-20s%-10s\n&quot;</span>, <span class="string" style="font-size: 16px; color: blue; background-color: inherit;">&quot;program&quot;</span>, <span class="string" style="font-size: 16px; color: blue; background-color: inherit;">&quot;pid&quot;</span>);  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">    list_for_each_safe(_p, _n, &amp;current-&gt;tasks) {  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">        p = list_entry(_p, struct task_struct, tasks);  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">        printk(<span class="string" style="font-size: 16px; color: blue; background-color: inherit;">&quot;%-20s%-10d\n&quot;</span>, p-&gt;comm, p-&gt;pid);  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">    }  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">%}  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">probe begin {  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">    process_list()  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">    exit()  </span></p></li><li><p><span style="color: black; font-size: 16px; background-color: inherit;">}  </span></p></li></ol><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">stap -g embeded-c.stp</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">dmesg可看到打印出的所有进程。</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">C代码用%{ ... %}括起来，可以是独立的一个段，可以作为函数的一部分，也可以只是一个表达式。</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><strong>(4) 已有脚本库</strong></span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">SystemTap默认提供了非常强大的脚本库，主要类别如下：</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Context Functions</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Timestamp Functions</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Time utility functions</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Shell command functions</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Memory Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Task Time Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Secheduler Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">IO Scheduler and block IO Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">SCSI Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">TTY Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Interrupt Request (IRQ) Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Networking Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Socket Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">SNMP Information Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Kernel Process Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Signal Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Errno Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Device Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Directory-entry (dentry) Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Logging Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Queue Statistics Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Random functions Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">String and data retrieving functions Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">String and data writing functions Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Guru tapsets</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">A collection of standard string functions</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Utility functions for using ansi control chars in logs</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">SystemTap Translator Tapset</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Network File Storage Tapsets</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Speculation</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><h2 style="font-family: Arial; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">实现原理</span></h2><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><strong>(1) SystemTap脚本的执行流程</strong></span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><img src="data:image/PNG;base64,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 " src="SeWfibBcBT0H554dHnwSDHtbJHIVA2eRibIhGwib2iasgiblJ4SkhfbAOxkhVd9VqaYF8Yg61GGaKBVh0nL64ic5LSRw"  style="border: none; font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);" class="" data-type="png" data-ratio="0.9796437659033079" data-w="393"  /></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><strong>pass1</strong></span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">During the parsing of the code, it is represented internally in a parse tree.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Preprocessing is performed during this step, and the code is checked for semantic and syntax errors.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><strong>pass2</strong></span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">During the elaboration step, the symbols and references in the SystemTap script are resolved.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Also, any tapsets that are referenced in the SystemTap script are imported.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Debug data that is read from the DWARF(a widely used, standardized debugging data format) information,</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">which is produced during kernel compilation, is used to find the addresses for functions and variables</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">referenced in the script, and allows probes to be placed inside functions.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><strong>pass3</strong></span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Takes the output from the elaboration phase and converts it into C source code.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Variables used by multiple probes are protected by locks. Safety checks, and any necessary locking, are</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">handled during the translation. The code is also converted to use the Kprobes API for inserting probe points</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">into the kernel.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><strong>pass4</strong></span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Once the SystemTap script has been translated into a C source file, the code is compiled into a module that</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">can be dynamically loaded and executed in the kernel.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><strong>pass5</strong></span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Once the module is built, SystemTap loads the module into the kernel.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">When the module loads, an init routine in the module starts running and begins inserting probes into their</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">proper locations. Hitting a probe causes execution to stop while the handler for that probe is called.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">When the handler exits, normal execution continues. The module continues waiting for probes and executing</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">handler code until the script exits, or until the user presses Ctrl-c, at which time SystemTap removes the</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">probes, unloads the module, and exits.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">Output from SystemTap is transferred from the kernel through a mechanism called relayfs, and sent to STDOUT.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><strong>(2) 从用户空间和内核空间来看SystemTap脚本的执行</strong></span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><img src="data:image/PNG;base64,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 " src="SeWfibBcBT0H554dHnwSDHtbJHIVA2eRibS7H2Ao5xx1Z00cZd6a1Ktpq1oArJaBt9H2RhGnqLwh4z9EZsr0MYHA"  style="border: none; font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);" class="" data-type="png" data-ratio="0.4646017699115044" data-w="452"  /></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><strong>(3) kprobes</strong></span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">断点指令(breakpoint instruction)：__asm INT 3，机器码为CC。</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">断点中断(INT3)是一种软中断，当执行到INT 3指令时，CPU会把当时的程序指针(CS和EIP)压入堆栈保存起来，</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">然后通过中断向量表调用INT 3所对应的中断例程。</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">INT是软中断指令，中断向量表是中断号和中断处理函数地址的对应表。</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">INT 3即触发软中断3，相应的中断处理函数的地址为：中断向量表地址 + 4 * 3。</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">A Kprobe is a general purpose hook that can be inserted almost anywhere in the kernel code.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">To allow it to probe an instruction, the first byte of the instruction is replaced with the breakpoint</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">instruction for the architecture being used. When this breakpoint is hit, Kprobe takes over execution,</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">executes its handler code for the probe, and then continues execution at the next instruction.</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"> </span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;"><strong>(4) 依赖的内核特性</strong></span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">kprobes/jprobes</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">return probes</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">reentrancy</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">colocated (multiple)</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">relayfs</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">scalability (unlocked handlers)</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">user-space probes</span></p><p style="font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"> </p><p><br  /></p>
                </div>
                

                
  <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display: none;"></div>


                
                <div class="read-more__area" id="js_more_read_area" style="display:none;">
                    
                </div>

                
                                <div class="reward_area tc reward_area_primary" id="js_preview_reward_author" style="display:none;">
                    <div class="reward-avatar" style="display: none;" id="js_preview_reward_author_avatar">
                        <img src="" alt="" id="js_preview_reward_author_head">
                    </div>
                    
                                        <div class="reward-author" id="js_preview_reward_author_name">zhangskd</div>
                                        <p class="reward_tips" id="js_preview_reward_author_wording" style="display:none;"></p>
                    <p class="reward_button_wrp">
                    
                      <span class="reward_pop_panel">
                        <img src="https://res.wx.qq.com/mpres/zh_CN/htmledition/pages/home/index/pic_mp_app4290ba.png" alt="">
                        <strong>扫一扫下载订阅号助手，用手机发文章</strong>
                      </span>
                        <a class="reward_button" id='js_preview_reward_author_link' href="##"><span id="js_preview_reward_link_text">赞赏</span></a>
                    </p>
                </div>

                <div class="reward_qrcode_area reward_area tc" id="js_preview_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                    <p id="js_preview_reward_ios_wording" class="reward_tips" style="display:none;"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" src="res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x42f400.png"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                            </div>
		<div class="comment">
			<h3 style="margin:26px 0;font-weight:100;padding-bottom:4px;border-bottom:1px solid #ccc;">精选留言</h3>
		    暂无...
		</div>
	</div>
	<div class='dy_all'>
		<a href='https://www.52pojie.cn/' target='_blank'>
			吾爱破解论坛
		</a>
	</div>
</body>