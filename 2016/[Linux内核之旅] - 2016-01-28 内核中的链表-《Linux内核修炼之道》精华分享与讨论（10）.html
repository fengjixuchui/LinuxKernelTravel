<!DOCTYPE html>
<head>
	<meta http-equiv='Content-Type' content='text/html;charset=utf-8'>
	<meta name='viewport' content='width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no'>
	<title>
		内核中的链表-《Linux内核修炼之道》精华分享与讨论（10）
	</title>
	<script src='https://cdn.bootcss.com/jquery/1.10.2/jquery.min.js'>
	</script>
	<style>
		a {color: #607fa6;text-decoration:none;word-wrap:break-word;word-break:break-all;}.rich_media_title{padding-bottom:10px;margin-bottom:14px;border-bottom:1px solid #e7e7eb;font-weight:400;} .rich_media_meta_list{font-size:14px;margin-bottom: 22px;}
		.rich_media_meta{display:inline-block;vertical-align:middle;margin-right:8px;margin-bottom:10px;font-size:14px;}.rich_media_meta_text{color:#8c8c8c;color:rgba(0, 0, 0, 0.3)}.rich_media_meta_list
		em {font-style: normal;}@media screen and (max-width:768px){.rich_media{position:
		relative;padding: 20px 15px 15px;background-color: #fff;}}.rich_media_content{text-align:justify;} .rich_media_content * {max-width:100%!important;box-sizing: border-box!important;-webkit-box-sizing:
		border-box!important;word-wrap: break-word!important;}.rich_media_content
		blockquote {margin: 0;padding-left: 10px;border-left: 3px solid #dbdbdb;}.rich_media_content
		.list-paddingleft-2 {padding-left: 2.2em;}a.rich_media_meta_nickname{display: none;}@media screen and (min-width:1025px){.rich_media{position:relative;}a.rich_media_meta_nickname{display:inline-block!important;}span.rich_media_meta_nickname
		{display: inline-block!important;}.rich_media {width:677px;margin-left:auto;margin-right:auto;}}a.fwjm{font-size: 12px;color: #ececec;}.tenvideo_player {position: relative;width:
		100 %;height: 100 %;margin: auto;background: #000;}* {margin:0px;padding:0px;} body{line-height: 1.6;letter-spacing: .034em;}
		.dy_all {text-align: center;margin: 30px 0;} .dy_all a {display: inline-block;height:
		38px;line-height: 38px;padding: 0 18px;background-color: #009688;color:
		#fff;white-space: nowrap;font-size: 14px;border: none;border-radius: 2px;cursor:
		pointer;text-align: center;outline: 0;-webkit-appearance: none;transition:
		all .3s;-webkit-transition: all .3s;box-sizing: border-box;} img{max-width: 677px!important;}

		.crawler-info{padding: 8px 0;} .article-link>img{margin-left: 20px;width: 16px;}
		.comment-item::before,.comment-item::after{content:'';display:block;height:0;visibility:hidden;clear:both;*zoom:1;} .comment-item{margin-bottom:30px;}
		.avatar{width:12%; padding-right:10px;float:left;box-sizing:border-box;} .avatar img{width:100%;}
		.comment-body{float:left;width:88%;} .comment-body .comment-info{color:#b3b3b3;margin-bottom:4px;margin-top: -5px;} .comment-body .comment-info>span:last-child{float:right;} 
		.comment-author{border-left:4px solid green;padding-left:6px;margin:8px 0;}

		@media screen and (max-width: 420px) {.article-link>img {margin-left: 0px;}}
		@media screen and (min-width: 480px) {.avatar {width: 9%;}.comment-body {width: 91%;}}
	</style>
</head>
<body>
	<div id='js_article' class='rich_media'>
		<div class="crawler-info">
			<a href='https://www.52pojie.cn' class='fwjm' target='_blank'>
				提供的爬取软件来源于：52pojie.cn@夜泉 免费下载使用
			</a>
			<a href='https://mp.weixin.qq.com/s?__biz=MzI3NzA5MzUxNA==&amp;mid=415855344&amp;idx=1&amp;sn=100f46dd4b8ba4be637d74f51e05c6d7&amp;scene=27#wechat_redirect&cpage=79' target='_blank' class="article-link">
				<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAQCAMAAABA3o1rAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ1IDc5LjE2MzQ5OSwgMjAxOC8wOC8xMy0xNjo0MDoyMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk4QUEzQzVDNkNGQjExRTk5NzNBQ0VBMjgzMjY1NjkwIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk4QUEzQzVENkNGQjExRTk5NzNBQ0VBMjgzMjY1NjkwIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OThBQTNDNUE2Q0ZCMTFFOTk3M0FDRUEyODMyNjU2OTAiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OThBQTNDNUI2Q0ZCMTFFOTk3M0FDRUEyODMyNjU2OTAiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5TKSKsAAAAclBMVEUuLi77+/stLS1VVVXx8fFOTk7s7Ozt7e1qamp5eXlNTU2WlpZFRUU6Ojrq6urn5+d/f3/8/Pw9PT0/Pz+YmJg8PDyZmZlAQECfn5+QkJBBQUFra2vo6OhDQ0OSkpKenp5WVlY+Pj7r6+tpaWksLCz///9o6ILHAAAAJnRSTlP/////////////////////////////////////////////////AKd6gbwAAACNSURBVHjajJHpEoIwDISDVMotcnuCmLz/K9KCdlqO6v7p7Mw3yW4KxG85fnUkIVfZ5J0SsCtqcgRw0HzjQYY2AAOIdRuaK4ReAPJ5nmglL5qICahpU60C0uXguQ9TgIwGJoDnT9z/ABmxt60ot0N2CsDLfb9mvBxs9ql+n5o9bEDBgbif7/1F4g80CjAAqrVAnnsm5f8AAAAASUVORK5CYII=" />
			</a>
		</div>
		<div id="img-content">

                
                <h2 class="rich_media_title" id="activity-name">内核中的链表-《Linux内核修炼之道》精华分享与讨论（10）</h2>
                <div id="meta_content" class="rich_media_meta_list">
                                                                                                            <span class="rich_media_meta rich_media_meta_text">
                                                        fudan_abc
                                                    </span>
                                                                
                                        <span class="rich_media_meta rich_media_meta_nickname" id="profileBt"><a href="javascript:void(0);">Linux内核之旅</a>
                      <div id="js_profile_qrcode" class="profile_container" style="display:none;">
                          <div class="profile_inner">
                              <strong class="profile_nickname">Linux内核之旅</strong>
                              <img class="profile_avatar" id="js_profile_qrcode_img" src="" alt="">

                              <p class="profile_meta">
                              <label class="profile_meta_label">微信号</label>
                              <span class="profile_meta_value">LinuxKernelTravel</span>
                              </p>

                              <p class="profile_meta">
                              <label class="profile_meta_label">功能介绍</label>
                              <span class="profile_meta_value">Linux内核之旅</span>
                              </p>
                              
                          </div>
                          <span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
                              <i class="profile_arrow arrow_out"></i>
                              <i class="profile_arrow arrow_in"></i>
                          </span>
                      </div>
                    </span>


                    <em id="publish_time" class="rich_media_meta rich_media_meta_text">2016-01-28</em>





                </div>

                
                
                                
                
                
                
                                                
                                                                
                                
                
                <div class="rich_media_content " id="js_content">
                    

                    

                    
                    
                    <p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">早上上班坐地铁要排队，到了公司楼下等电梯要排队，中午吃饭要排队，下班了追求一个女孩子也要排队，甚至在网上下载个什么门的短片也要排队，每次看见人群排成一条长龙时，才真正意识到自己是龙的传人。那么下面咱们就说说队列（链表）。</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">使用链表的目的很明确，因为有很多事情要做，于是就把它放进链表里，一件事一件事的处理。比如在USB子系统里，U盘不停的提交urb请求，USB键盘也提交，USB鼠标也提交，那USB主机控制器咋应付得过来呢？很简单，建一个链表，然后你每次提交就是往里边插入，然后USB主机控制器再统一去调度，一个一个来执行。这里有力得证明了，谭浩强大哥的C程序设计是我们学习Linux的有力武器，书中对链表的介绍无疑是英明的，谭大哥，您不是一个人在战斗！</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">内核中链表的实现位于include/linux/list.h文件，链表数据结构的定义也很简单。</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">21 struct list_head {</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">22&nbsp;&nbsp; struct list_head *next, *prev;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">23 };</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">list_head结构包含两个指向list_head结构的指针prev和next，由此可见，内核中的链表实际上都是双链表（通常都是双循环链表）。</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">通常，我们在数据结构课堂上所了解的链表定义方式是这样的（以单链表为例）：</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">struct list_node {</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">&nbsp;&nbsp;&nbsp; struct list_node *next;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">&nbsp;&nbsp;&nbsp; ElemType data;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">};</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">通过这种方式使用链表，对每一种数据类型，都要定义它们各自的链表结构。而内核中的链表却与此不同，它并没有数据域，不是在链表结构中包含数据，而是在描述数据类型的结构中包含链表。</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">比如在hub驱动中使用struct usb_hub来描述hub设备，hub需要处理一系列的事件，比如当探测到一个设备连进来时，就会执行一些代码去初始化该设备，所以hub就创建了一个链表来处理各种事件，这个链表的结构如下图。</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><img data-s="300,640" data-type="png" src="data:image/PNG;base64,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 " src="SeWfibBcBT0GQ4iaicKBGaRNUxZAb4icbjBSWXic0tBzTKUH0aibzRFQY6rlVpRTDBuFjjNPoJw4KDvOyopUugN1jxLQ"  data-ratio="0.42907801418439717" data-w="282"  /><br  /><span style="font-size: 16px;">（1）声明与初始化。</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">链表的声明可以使用两种方式，一种为使用LIST_HEAD宏在编译时静态初始化，一种为使用INIT_LIST_HEAD()在运行时进行初始化。</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">25 #define LIST_HEAD_INIT(name) { &amp;(name), &amp;(name) }</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">26</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">27 #define LIST_HEAD(name) /</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">28&nbsp;&nbsp; struct list_head name = LIST_HEAD_INIT(name)</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">29</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">30 static inline void INIT_LIST_HEAD(struct list_head *list)</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">31 {</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">32&nbsp;&nbsp; list-&gt;next = list;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">33&nbsp;&nbsp; list-&gt;prev = list;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">34 }</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">无论采用哪种方式，新生成的链表头的两个指针next、prev都初始化为指向自己。</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">（2）判断链表是否为空。</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">298 static inline int list_empty(const struct list_head *head)</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">299 {</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">300&nbsp;&nbsp; return head-&gt;next == head;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">301 }</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">（3）插入。</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">有了链表，自然就要往里面加东西、减东西。就像我们每个人每天都在不停的走进去，又走出来，似是梦境又不是梦境。一切都是不经意的。走进去是一年四季，走出来是春夏秋冬。list_add()和list_add_tail()这两个函数就是往队列里加东西。</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">67 static inline void list_add(struct list_head *new, struct list_head *head)</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">68 {</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">69&nbsp;&nbsp; __list_add(new, head, head-&gt;next);</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">70 }</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">84 static inline void list_add_tail(struct list_head *new, struct list_head *head)</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">85 {</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">86&nbsp;&nbsp; __list_add(new, head -&gt;prev, head);</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">87 }</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">其中，list_add()将数据插入在head之后，list_add_tail()将数据插入在head-&gt;prev之后。其实对于循环链表来说，表头的next、prev分别指向链表中的第一个和最后一个节点，所以，list_add()和list_add_tail()的区别并不大。</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">（4）删除。</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">搞懂谭浩强那本书之后看这些链表的代码那就是小菜一碟。再来看下一个 list_del_init()，里的元素不能只加不减，没用了的元素就该删除掉，把空间腾出来给别人。郭敬明说过，我生命里的温暖就那么多，我全部给了你，但是你离开了我，你叫我以后怎么再对别人笑……</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">链表里的元素不能只加不减，没用了的元素就应该删除掉。</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">254 static inline void list_del_init(struct list_head *entry)</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">255 {</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">256&nbsp;&nbsp;&nbsp;&nbsp; __list_del(entry-&gt;prev, entry-&gt;next);</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">257&nbsp; INIT_LIST_HEAD(entry);</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">258 }</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">list_del_init()从链表里删除一个元素，并且将其初始化。</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">（5）遍历。</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">内核中的链表仅仅保存了list_head结构的地址，我们如何通过它或取一个链表节点真正的数据项？这就要提到有关链表的所有操作里面，最为重要超级经典的list_entry宏了，我们可以通过它很容易地获得一个链表节点的数据。</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">425 #define list_entry(ptr, type, member) /</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">426&nbsp; container_of(ptr, type, member)</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">我相信，list_entry()这个宏在Linux内核代码中的地位，就相当于广告词中的任静付笛生的洗洗更健康，相当于大美女关之琳的一分钟轻松做女人，这都是耳熟能详妇孺皆知的，是经典中的经典。如果你说你不知道list_entry()，那你千万别跟人说你懂Linux内核，就好比你不知道陈文登不知道任汝芬你就根本不好意思跟人说你考过研，要知道每个考研人都是左手一本陈文登右手一本任汝芬。</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">可惜，关于list_entry，这个谭浩强老师的书里就没有了，当然你不能指责谭浩强的书不行，再好的书也不可能包罗万象。</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">关于list_entry()，让我们结合实例来看，还是hub驱动的那个例子，当我们真的要处理hub的事件的时候，我们当然需要知道具体是哪个hub触发了这起事件。而list_entry的作用就是，从struct list_head event_list得到它所对应的struct usb_hub结构体变量。比如以下四行代码：</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">&nbsp;&nbsp;&nbsp; struct list_head *tmp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">&nbsp;&nbsp;&nbsp; struct usb_hub *hub;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">&nbsp;&nbsp;&nbsp; tmp = hub_event_list.next;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 255); font-size: 16px;">&nbsp;&nbsp;&nbsp; hub = list_entry(tmp, struct usb_hub, event_list);</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">&nbsp;</span></p><p style="color: rgb(51, 51, 51); font-family: Arial; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);"><span style="font-size: 16px;">从全局链表hub_event_list中取出一个来，叫做tmp，然后通过tmp，获得它所对应的struct usb_hub。</span></p><p><br  /></p>
                </div>
                

                
  <div class="ct_mpda_wrp" id="js_sponsor_ad_area" style="display: none;"></div>


                
                <div class="read-more__area" id="js_more_read_area" style="display:none;">
                    
                </div>

                
                                <div class="reward_area tc reward_area_primary" id="js_preview_reward_author" style="display:none;">
                    <div class="reward-avatar" style="display: none;" id="js_preview_reward_author_avatar">
                        <img src="" alt="" id="js_preview_reward_author_head">
                    </div>
                    
                                        <div class="reward-author" id="js_preview_reward_author_name">fudan_abc</div>
                                        <p class="reward_tips" id="js_preview_reward_author_wording" style="display:none;"></p>
                    <p class="reward_button_wrp">
                    
                      <span class="reward_pop_panel">
                        <img src="https://res.wx.qq.com/mpres/zh_CN/htmledition/pages/home/index/pic_mp_app4290ba.png" alt="">
                        <strong>扫一扫下载订阅号助手，用手机发文章</strong>
                      </span>
                        <a class="reward_button" id='js_preview_reward_author_link' href="##"><span id="js_preview_reward_link_text">赞赏</span></a>
                    </p>
                </div>

                <div class="reward_qrcode_area reward_area tc" id="js_preview_reward_qrcode" style="display:none;">
                    <p class="tips_global">长按二维码向我转账</p>
                    <p id="js_preview_reward_ios_wording" class="reward_tips" style="display:none;"></p>
                    <span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" src="res.wx.qq.com/mmbizwap/zh_CN/htmledition/images/pic/appmsg/pic_reward_qrcode.2x42f400.png"></span>
                    <p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
                </div>
                            </div>
		<div class="comment">
			<h3 style="margin:26px 0;font-weight:100;padding-bottom:4px;border-bottom:1px solid #ccc;">精选留言</h3>
		    暂无...
		</div>
	</div>
	<div class='dy_all'>
		<a href='https://www.52pojie.cn/' target='_blank'>
			吾爱破解论坛
		</a>
	</div>
</body>